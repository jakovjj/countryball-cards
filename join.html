<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <meta name="referrer" content="no-referrer-when-downgrade" />
  <title>Join Newsletter - Countryball Cards</title>
  <meta name="description" content="Reserve your early bird spot for Countryball Cards! Get 5â‚¬ discount when we launch on Kickstarter October 1st, 2025." />
  <link rel="canonical" href="https://countryballcards.com/" />
  <meta name="robots" content="index,follow" />
  <meta name="theme-color" content="#151515" />
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://countryballcards.com/">
  <meta property="og:title" content="Reserve Your Early Bird Spot - Countryball Cards">
  <meta property="og:description" content="Kickstarter launches October 1st! Reserve your spot now for 5â‚¬ early bird discount on strategic countryball card game.">
  <meta property="og:image" content="https://countryballcards.com/logo.png">
  <meta property="og:site_name" content="Countryball Cards">
  
  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="https://countryballcards.com/">
  <meta property="twitter:title" content="Reserve Your Early Bird Spot - Countryball Cards">
  <meta property="twitter:description" content="Kickstarter launches October 1st! Reserve your spot now for 5â‚¬ early bird discount on strategic countryball card game.">
  <meta property="twitter:image" content="https://countryballcards.com/logo.png">
  
  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <link rel="icon" sizes="any" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
  <link rel="manifest" href="site.webmanifest">
  
  <!-- Performance hints -->
  <link rel="preconnect" href="https://www.googletagmanager.com" crossorigin>
  <link rel="preconnect" href="https://www.google-analytics.com" crossorigin>
  <link rel="preconnect" href="https://www.redditstatic.com" crossorigin>
  <link rel="preconnect" href="https://ads.reddit.com" crossorigin>
  <link rel="preconnect" href="https://mineward.us.to" crossorigin>
  <link rel="dns-prefetch" href="https://api.emailjs.com">
  <link rel="dns-prefetch" href="https://pixel-config.reddit.com">
  <link rel="dns-prefetch" href="https://events.reddit.com">
  
  <!-- Preload critical assets -->
  <link rel="preload" as="image" href="logo.png" fetchpriority="high" />
  <link rel="preload" href="styles.css?v=2025081801" as="style" />
  <link rel="preload" href="js/email-collector.js?v=1.0.0" as="script" />
  
  <!-- Google tag (GA4) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-M366HCYL8Z"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);} 
    gtag('js', new Date());
    gtag('config', 'G-M366HCYL8Z', {
      transport_type: 'beacon',
      anonymize_ip: true,
      allow_google_signals: false
    });
  </script>
  
  <!-- Critical CSS (above-the-fold) -->
  <style>
    :root{--bg:#151515;--card:#1d1d1d;--gold:#c7a455;--text:#eee;--muted:#b7b7b7}
    *{box-sizing:border-box;max-width:100%}
    body{margin:0;background:var(--bg);color:var(--text);font:16px/1.4 system-ui,Segoe UI,Inter,Arial;overflow-x:hidden;max-width:100vw}
    .wrap{max-width:980px;margin:0 auto;padding:28px;box-sizing:border-box}
    .frame{border:3px solid var(--gold);border-radius:18px;padding:28px;box-sizing:border-box;max-width:100%;opacity:1}
    .join-container{min-height:calc(100vh - 112px);display:flex;flex-direction:column;justify-content:center;align-items:center;padding:0;box-sizing:border-box;text-align:center}
    .join-logo{max-width:200px;height:auto;margin:0 auto 20px;display:block}
    .join-title{font-size:clamp(28px,5vw,36px);color:var(--text);margin:0 auto 16px;font-weight:700;text-align:center}
    .join-subtitle{color:var(--muted);margin:0 auto 32px;font-size:16px;line-height:1.4;max-width:500px;text-align:center}
    .success-message{display:none;background:rgba(40,167,69,0.1);border:2px solid rgba(40,167,69,0.5);border-radius:12px;padding:24px;margin-bottom:20px;color:#28a745;font-size:14px;font-weight:600;text-align:center;max-width:500px;width:100%;box-sizing:border-box}
    .success-message.show{display:block !important}
    .success-message h3{color:#28a745;margin:0 0 12px 0;font-size:18px}
    .success-message p{margin:0 0 16px 0;line-height:1.4}
    .homepage-btn{background:var(--gold);color:var(--bg);padding:10px 20px;border:none;border-radius:8px;font-size:14px;font-weight:700;text-decoration:none;display:inline-flex;align-items:center;gap:6px;cursor:pointer;transition:all 0.3s ease}
    .homepage-btn:hover{background:#b8954a;transform:translateY(-2px)}
    .join-footer{margin-top:auto;padding-top:24px;color:var(--muted);font-size:12px;text-align:center}
    .join-footer a{color:var(--gold);text-decoration:none}
    .join-footer a:hover{text-decoration:underline}
    .email-form-container{max-width:400px;width:100%;text-align:center;margin:0 auto}
    .email-input{padding:16px 20px;border:3px solid var(--gold);border-radius:12px !important;background:rgba(255,255,255,0.05);color:var(--text);font-size:16px;width:100%;margin:0 auto 16px;box-sizing:border-box;transition:all 0.3s ease;box-shadow:0 0 0 2px rgba(199,164,85,0.3);text-align:center;-webkit-appearance:none !important;-moz-appearance:none !important;appearance:none !important;-webkit-border-radius:12px !important;-moz-border-radius:12px !important}
    .email-input:focus{outline:none;border-color:var(--gold);box-shadow:0 0 0 4px rgba(199,164,85,0.5);background:rgba(255,255,255,0.08)}
    .email-input::placeholder{color:rgba(238,238,238,0.6);text-align:center}
    .email-submit{padding:16px 24px;background:linear-gradient(135deg,var(--gold),#d4b866);border:none;border-radius:12px;color:var(--bg);font-size:16px;font-weight:700;cursor:pointer;transition:all 0.3s ease;display:flex;align-items:center;justify-content:center;gap:8px;width:100%;box-sizing:border-box;margin:0 auto}
    .email-submit:hover{background:linear-gradient(135deg,#d4b866,#e6c875);transform:translateY(-2px)}
    .form-message{margin:16px auto 0;padding:0;font-size:14px;font-weight:600;text-align:center;max-width:400px}
    .form-message.success{color:#00ff88}
    .form-message.error{color:#ff6b6b}
    .inline-email-submit:hover{background:linear-gradient(135deg,#d4b866,#e6c875);transform:translateY(-2px)}
    .inline-submit-icon{width:16px;height:16px;fill:currentColor}
    .inline-submit-text{white-space:nowrap}
    .inline-form-message{margin:0;padding:0;height:0;overflow:hidden;font-size:14px;font-weight:600}
    .inline-form-message.success{color:#00ff88;height:auto;padding:8px 0}
    .inline-form-message.error{color:#ff6b6b;height:auto;padding:8px 0}
    svg{flex-shrink:0}
    input,button{font-family:inherit}
    @keyframes fadeIn{from{opacity:0}to{opacity:1}}
    .join-content{animation:fadeIn 0.3s ease-in-out}
    @media(max-width:768px){
      .join-content{padding:20px 16px}
      .join-logo{max-width:120px}
      .email-input{
        -webkit-border-radius:12px !important;
        -moz-border-radius:12px !important;
        border-radius:12px !important;
        -webkit-appearance:none !important;
        -moz-appearance:none !important;
        appearance:none !important;
      }
    }
    @media(max-width:480px){
      .email-input{
        -webkit-border-radius:12px !important;
        -moz-border-radius:12px !important;
        border-radius:12px !important;
        -webkit-appearance:none !important;
        -moz-appearance:none !important;
        appearance:none !important;
        border-style:solid !important;
        border-width:3px !important;
        border-color:var(--gold) !important;
      }
    }
  </style>
  
  <!-- Load non-critical CSS asynchronously -->
  <link rel="preload" href="styles.css?v=2025081801" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="styles.css?v=2025081801"></noscript>

  <!-- Countryball Cards Email Collection System - defer to avoid blocking -->
  <script src="js/email-collector.js?v=1.0.0" defer></script>
  
  <!-- Performance monitoring and optimization -->
  <script src="performance.js?v=1.0.0" defer></script>
  
  <!-- Service Worker Registration -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js')
          .then(registration => console.log('SW registered'))
          .catch(error => console.log('SW registration failed'));
      });
    }
  </script>
</head>
<body>
  <div class="wrap">
    <div class="frame">
      <div class="join-container">
        <img src="logo.png" alt="Countryball Cards" class="join-logo" onerror="this.style.display='none';">
        
        <div class="success-message" id="successMessage" style="display:none;">
          <h3>ðŸŽ‰ Early Bird Spot Reserved!</h3>
          <p>You'll get your 5â‚¬ discount when we launch on Kickstarter October 1st!</p>
          
          <a href="index.html" class="homepage-btn" style="margin-top: 8px;">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
              <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
            </svg>
            Go to Homepage
          </a>
        </div>
        
        <div id="emailFormContainer">
          <h1 class="join-title">ðŸš€ Stay Updated!</h1>
          <p class="join-subtitle">
            <strong>Launching Oct 1 on Kickstarter</strong><br>
            Sign up for updates, get an <span style="color: var(--gold); font-weight: 600;">early bird discount</span> and be first in line when we go live.
          </p>
          
          <div class="email-form-container">
            <form id="joinEmailForm">
              <input 
                type="email" 
                id="joinEmailInput" 
                placeholder="Enter your email address" 
                required 
                autocomplete="email"
                class="email-input"
              >
              <button type="submit" class="email-submit" id="joinEmailSubmitBtn">
                <span>Get Updates</span>
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M2,21L23,12L2,3V10L17,12L2,14V21Z"/>
                </svg>
              </button>
              <div class="form-message" id="joinFormMessage"></div>
            </form>
          </div>
        </div>
        
        <div class="privacy-notice" style="font-size:10px;color:var(--muted);margin:12px auto 0;text-align:center;max-width:400px">
          By subscribing, you agree to our <a href="privacy-policy.html" style="color:var(--gold);text-decoration:none">Privacy Policy</a>
        </div>
      </div>
    </div>
    
    <div class="join-footer">
      Â© 2025 Glare Studios â€¢ Made for fans of countryballs & strategy.<br>
      <a href="privacy-policy.html">Privacy Policy</a> â€¢ 
      <a href="terms-and-conditions.html">Terms & Conditions</a>
    </div>
  </div>

  <script>
    // Eurozone countries
    const eurozoneCountries = [
      'AT', 'BE', 'CY', 'EE', 'FI', 'FR', 'DE', 'GR', 'IE', 'IT', 'LV', 'LT', 'LU', 'MT', 'NL', 'PT', 'SK', 'SI', 'ES', 'HR'
    ];

    // Currency conversion for discount display
    function updateDiscountCurrency() {
      try {
        fetch('https://ipapi.co/json/')
          .then(response => response.json())
          .then(data => {
            const countryCode = data.country_code;
            const isEurozone = eurozoneCountries.includes(countryCode);
            
            // Update discount amount in subtitle
            const subtitleEl = document.querySelector('.join-subtitle');
            if (subtitleEl) {
              let currentText = subtitleEl.innerHTML;
              if (isEurozone) {
                // Show EUR (already default)
                currentText = currentText.replace(/\$6 early bird discount/g, '5â‚¬ early bird discount');
              } else {
                // Show USD
                currentText = currentText.replace(/5â‚¬ early bird discount/g, '$6 early bird discount');
              }
              subtitleEl.innerHTML = currentText;
            }
          })
          .catch(() => {
            // Default to EUR if detection fails
            console.log('Country detection failed, using EUR pricing');
          });
      } catch (error) {
        console.log('Currency update error:', error);
      }
    }

    // Email form functionality for join page
    document.addEventListener('DOMContentLoaded', function() {
      // Initialize currency display
      updateDiscountCurrency();
      
      // Initialize join form after a short delay to ensure all scripts are loaded
      setTimeout(() => {
        initializeJoinForm();
      }, 100);
    });

    function initializeJoinForm() {
      // Initialize the new email collector
      const emailCollector = new CountryballEmailCollector({ debug: true });
      
      const joinEmailForm = document.getElementById('joinEmailForm');
      const joinEmailInput = document.getElementById('joinEmailInput');
      const joinSubmitBtn = document.getElementById('joinEmailSubmitBtn');
      const joinFormMessage = document.getElementById('joinFormMessage');
      const successMessage = document.getElementById('successMessage');
      const emailFormContainer = document.getElementById('emailFormContainer');
      
      if (!joinEmailForm || !joinEmailInput || !joinSubmitBtn || !joinFormMessage) {
        console.error('Join form elements not found');
        return;
      }
      
      function validateEmail(email) {
        const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return re.test(email);
      }
      
      function showMessage(message, type) {
        joinFormMessage.className = `form-message ${type}`;
        joinFormMessage.textContent = message;
        joinFormMessage.style.display = message ? 'block' : 'none';
      }
      
      function showSuccess() {
        console.log('Showing success message...');
        
        // Hide the form container
        emailFormContainer.style.display = 'none';
        
        // Show the success message
        successMessage.style.display = 'block';
        successMessage.classList.add('show');
        
        console.log('Success message visibility:', window.getComputedStyle(successMessage).display);
        console.log('Success message classes:', successMessage.classList.toString());
        
        // Track successful signup
        try {
          if (window.rdt) {
            rdt('track', 'SignUp', {
              event_name: 'EmailSignup',
              content_name: 'Newsletter',
              content_category: 'Email Marketing',
              content_ids: ['join_page_signup'],
              content_type: 'signup'
            });
          }
        } catch (_) {}
        
        try {
          if (window.gtag) {
            gtag('event', 'email_signup', {
              event_category: 'conversion',
              event_label: 'join_page',
              value: 1
            });
          }
        } catch (_) {}
      }
      
      async function handleSubmit(e) {
        e.preventDefault();
        e.stopPropagation(); // Prevent any other handlers from firing
        
        const email = joinEmailInput.value.trim();
        
        if (!email) {
          showMessage('Please enter your email address.', 'error');
          joinEmailInput.focus();
          return;
        }
        
        if (!validateEmail(email)) {
          showMessage('Please enter a valid email address.', 'error');
          joinEmailInput.focus();
          return;
        }
        
        // Show loading state
        joinSubmitBtn.disabled = true;
        joinSubmitBtn.classList.add('loading');
        const originalText = joinSubmitBtn.querySelector('span').textContent;
        joinSubmitBtn.querySelector('span').textContent = 'Subscribing...';
        showMessage('', '');
        
        try {
          console.log('Submitting email using EmailCollector...');
          
          // Use the EmailCollector's subscribe method
          const result = await emailCollector.subscribe(email, {
            source: 'join_page',
            formData: {
              page_url: window.location.href,
              page_title: document.title,
              timestamp: new Date().toISOString()
            }
          });

          console.log('Email subscription successful:', result);
          showSuccess();

        } catch (error) {
          console.error('Email signup error:', error);
          showMessage('Something went wrong. Please try again later.', 'error');
        } finally {
          // Reset button state
          joinSubmitBtn.disabled = false;
          joinSubmitBtn.classList.remove('loading');
          joinSubmitBtn.querySelector('span').textContent = originalText;
        }
      }
      
      // Add event listener
      joinEmailForm.addEventListener('submit', handleSubmit);
      
      // Focus effects
      joinEmailInput.addEventListener('focus', function() {
        this.style.boxShadow = '0 0 0 4px rgba(199, 164, 85, 0.3)';
      });
      
      joinEmailInput.addEventListener('blur', function() {
        this.style.boxShadow = '';
      });
      
      console.log('Join form initialized successfully');
    }
  </script>

  <!-- Reddit Pixel Code -->
  <script>
    !function(w,d){
      if(!w.rdt){
        var p=w.rdt=function(){
          p.sendEvent?p.sendEvent.apply(p,arguments):p.callQueue.push(arguments)
        };
        p.callQueue=[];
        var t=d.createElement("script");
        t.src="https://www.redditstatic.com/ads/pixel.js",t.async=!0;
        var s=d.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(t,s)
      }
    }(window,document);
    
    rdt('init','a2_hgzcstbb8534', {
      optOut: false,
      useDecimalCurrencyValues: true
    });
    rdt('track', 'PageVisit');
  </script>
  </script>
  </script>
</body>
</html>
